var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;"undefined"!=typeof require&&require;import{H as r,a as m}from"./index.2c6e8c15.js";import{s as c}from"./dictFormat.b2531267.js";import{u as i}from"./useDrawer.6ddc8ed7.js";import{_ as d}from"./index.440d206b.js";import{u}from"./useI18n.94ac6758.js";import{d as f,c as y,a as p,r as g,f as C,a6 as h,M as k,n as v,q as b,a3 as w,t as S,A as x,B as _,k as N,x as T,a4 as j,V as P,U as R,v as O,H as E}from"./ant-design-vue.5cd75ca8.js";const{t:F}=u(),U=[{title:F("routes.systemConfig.name"),dataIndex:"name",key:"name",align:"center"},{title:F("routes.systemConfig.keyName"),dataIndex:"keyName",key:"keyName",align:"center"},{title:F("routes.systemConfig.key"),dataIndex:"key",key:"key",align:"center"},{title:F("routes.systemConfig.remark"),dataIndex:"remark",key:"remark",align:"center"},{title:F("routes.systemConfig.createdBy"),dataIndex:"createdBy",key:"createdBy",align:"center"},{title:F("routes.systemConfig.createdAt"),dataIndex:"createdAt",key:"createdAt",align:"center"},{title:F("routes.systemConfig.action"),key:"action",align:"center",slots:{customRender:"action"}}];var I=f({components:{FormSearch:d},setup(){const e=y((()=>m().loading)),d={name:[{required:!0,message:F("routes.systemConfig.nameCannotBeEmpty"),trigger:"blur"}],keyName:[{required:!0,message:F("routes.systemConfig.keyNameCannotBeEmpty"),trigger:"blur"}],key:[{required:!0,message:F("routes.systemConfig.keyCannotBeEmpty"),trigger:"change"}]},u=p([{type:"input",label:F("routes.systemConfig.name"),name:"name",value:"",placeholder:F("routes.systemConfig.namePlaceholder")}]),f=p({pageNum:1,pageSize:10,name:"",keyName:"",status:""}),b=g([]),w=g({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),S=p({selectedRowKeys:[]}),x=y((()=>S.selectedRowKeys.length>0)),_=e=>{(function(e={}){return r("/admin/system/systemConfig","GET",e)})(e).then((e=>{b.value=e.data.rows,w.value.total=e.data.count,S.selectedRowKeys=[]}))},N=g(),T=p({id:void 0,name:void 0,keyName:void 0,status:"1",key:void 0}),{open:j,drawerTitle:P}=i();return C((async()=>{_(f)})),R=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&s(e,t,a[t]);if(l)for(var t of l(a))n.call(a,t)&&s(e,t,a[t]);return e})({t:F,loading:e,queryParams:f,formFields:u,handleQuery:e=>{w.value.current=1,f.pageNum=w.value.current,f.name=e.name,f.keyName=e.keyName,f.status=e.status,_(f)},systemConfigList:b,columns:U,pagination:w,handleTableChange:e=>{w.value=e,f.pageNum=w.value.current,f.pageSize=w.value.pageSize,_(f)},selectDictLabel:c},h(S)),a(R,t({hasSelected:x,onSelectChange:e=>{S.selectedRowKeys=e},open:j,drawerTitle:P,formState:T,labelCol:{span:4},wrapperCol:{span:18},rules:d,formRef:N,handleClose:()=>{T.id=void 0,N.value.resetFields(),j.value=!1},handleSubmit:()=>{N.value.validate().then((()=>{var e;T.id?(e=T,r("/admin/system/systemConfig/"+e.id,"PUT",e)).then((e=>{k.success(e.message),_(f),T.id=void 0,N.value.resetFields(),j.value=!1})):function(e={}){return r("/admin/system/systemConfig","POST",e)}(T).then((e=>{k.success(e.message),_(f),T.id=void 0,N.value.resetFields(),j.value=!1}))})).catch((e=>{}))},confirm:e=>{const a=e.id||S.selectedRowKeys;(function(e){return r("/admin/system/systemConfig/"+e,"DELETE")})(a).then((()=>{(a.length&&a.length===b.value.length||1===b.value.length)&&Math.ceil(w.value.total/f.pageSize)===f.pageNum&&f.pageNum>1&&f.pageNum--,_(f),k.success(F("common.deleteSuccess"))}))},cancel:e=>{k.success(F("common.cancelDelete"))},handleAdd:()=>{j.value=!0,P.value=F("common.add")},handleUpdate:e=>{var a;(a=e.id,r("/admin/system/systemConfig/"+a,"GET",{},!1)).then((e=>{j.value=!0,P.value=F("common.update"),v((()=>{Object.keys(T).forEach((a=>{T[a]=e.data[a]}))}))}))}}));var R}});const K={class:"p-4"},q={class:"mb-3"};I.render=function(e,a,t,l,o,n){const s=b("form-search"),r=b("a-button"),m=b("a-col"),c=b("a-popconfirm"),i=b("a-row"),d=b("a-table"),u=b("a-input"),f=b("a-form-item"),y=b("a-textarea"),p=b("a-form"),g=b("a-drawer"),C=w("has-permi");return S(),x("div",K,[_("div",q,[N(s,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),N(i,{gutter:10,class:"mb-2"},{default:T((()=>[j(N(m,null,{default:T((()=>[N(r,{color:"success",onClick:e.handleAdd},{default:T((()=>[P(R(e.t("common.add")),1)])),_:1},8,["onClick"])])),_:1},512),[[C,["system:systemConfig:add"]]]),j(N(m,null,{default:T((()=>[N(c,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:e.confirm,onCancel:e.cancel},{default:T((()=>[N(r,{disabled:!e.hasSelected,color:"error"},{default:T((()=>[P(R(e.t("common.update")),1)])),_:1},8,["disabled"])])),_:1},8,["title","ok-text","cancel-text","onConfirm","onCancel"])])),_:1},512),[[C,["system:systemConfig:delete"]]])])),_:1}),N(d,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.systemConfigList,pagination:e.pagination,onChange:e.handleTableChange},{action:T((({record:a})=>[_("span",null,[j(N(r,{type:"link",color:"success",class:"mr-3",onClick:t=>e.handleUpdate(a)},{default:T((()=>[P(R(e.t("common.update")),1)])),_:2},1032,["onClick"]),[[C,["system:systemConfig:update"]]]),N(c,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:t=>e.confirm(a),onCancel:e.cancel},{default:T((()=>[j(N(r,{type:"link",color:"error"},{default:T((()=>[P(R(e.t("common.delete")),1)])),_:1},512),[[C,["system:systemConfig:delete"]]])])),_:2},1032,["title","ok-text","cancel-text","onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),N(g,{width:"600px",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":a[4]||(a[4]=a=>e.open=a),maskClosable:!1,onClose:e.handleClose},{default:T((()=>[e.open?(S(),O(p,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:T((()=>[N(i,null,{default:T((()=>[N(m,{span:24},{default:T((()=>[N(f,{label:e.t("routes.systemConfig.name"),name:"name"},{default:T((()=>[N(u,{value:e.formState.name,"onUpdate:value":a[0]||(a[0]=a=>e.formState.name=a),placeholder:e.t("routes.systemConfig.namePlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),N(m,{span:24},{default:T((()=>[N(f,{label:e.t("routes.systemConfig.keyName"),name:"keyName"},{default:T((()=>[N(u,{value:e.formState.keyName,"onUpdate:value":a[1]||(a[1]=a=>e.formState.keyName=a),placeholder:e.t("routes.systemConfig.keyNamePlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),N(m,{span:24},{default:T((()=>[N(f,{label:e.t("routes.systemConfig.key"),name:"key"},{default:T((()=>[N(u,{value:e.formState.key,"onUpdate:value":a[2]||(a[2]=a=>e.formState.key=a),placeholder:e.t("routes.systemConfig.keyPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),N(m,{span:24},{default:T((()=>[N(f,{label:e.t("routes.systemConfig.remark"),name:"remark"},{default:T((()=>[N(y,{rows:3,value:e.formState.remark,"onUpdate:value":a[3]||(a[3]=a=>e.formState.remark=a),placeholder:e.t("routes.systemConfig.remarkPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),N(m,{span:24},{default:T((()=>[N(f,null,{default:T((()=>[N(r,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:T((()=>[P(R(e.t("common.okText")),1)])),_:1},8,["onClick"]),N(r,{onClick:e.handleClose},{default:T((()=>[P(R(e.t("common.cancelText")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):E("",!0)])),_:1},8,["title","visible","onClose"])])};export{I as default};
