var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{H as i,a as c}from"./index.e0281189.js";import{g as r,s as d}from"./dictFormat.fa6d45c4.js";import{u}from"./useDrawer.60140d94.js";import{_ as p}from"./index.d425032d.js";import{d as m,c as f,r as y,a as v,f as g,a6 as h,M as b,n as C,l as T,a3 as _,m as w,A as S,B as k,v as O,t as x,a4 as R,V as j,q as F,F as L,Z as K,U,H as z}from"./ant-design-vue.8fffeee5.js";const E=[{title:"标题",dataIndex:"noticeTitle",key:"noticeTitle",align:"center"},{title:"类型",dataIndex:"noticeType",key:"noticeType",align:"center",slots:{customRender:"noticeType"}},{title:"内容",dataIndex:"noticeContent",key:"noticeContent",align:"center"},{title:"状态",dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:"创建者",dataIndex:"createdBy",key:"createdBy",align:"center"},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"操作",key:"action",align:"center",slots:{customRender:"action"}}];var P=m({components:{FormSearch:p},setup(){const e=f((()=>c().loading)),p=y([]),m=y([]),T=y([]),_=v([{type:"input",label:"标题",name:"noticeTitle",value:"",placeholder:"请输入标题"},{type:"select",label:"类型",name:"noticeType",value:void 0,placeholder:"请选择类型",normalizer:{value:"dictValue",label:"dictLabel"},options:T},{type:"select",label:"状态",name:"status",value:void 0,placeholder:"请选择角色状态",normalizer:{value:"dictValue",label:"dictLabel"},options:p}]),w=v({pageNum:1,pageSize:10,noticeTitle:"",noticeType:"",status:""}),S=y([]),k=y({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),O=v({selectedRowKeys:[]}),x=f((()=>O.selectedRowKeys.length>0)),R=e=>{(function(e={}){return i("/admin/system/notice","GET",e)})(e).then((e=>{console.log(e),S.value=e.data.rows,k.value.total=e.data.count,O.selectedRowKeys=[]}))},j=y(),F=v({id:void 0,noticeTitle:void 0,noticeType:void 0,status:"1",noticeContent:void 0}),{open:L,drawerTitle:K}=u();console.log(L);return g((async()=>{p.value=await r("sys_normal_disable"),T.value=await r("sys_notice_type"),m.value=await r("sys_normal_disable"),m.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),R(w)})),U=((e,t)=>{for(var a in t||(t={}))o.call(t,a)&&s(e,a,t[a]);if(l)for(var a of l(t))n.call(t,a)&&s(e,a,t[a]);return e})({loading:e,queryParams:w,formFields:_,handleQuery:e=>{k.value.current=1,w.pageNum=k.value.current,w.noticeTitle=e.noticeTitle,w.noticeType=e.noticeType,w.status=e.status,R(w)},noticeList:S,columns:E,pagination:k,handleTableChange:e=>{k.value=e,w.pageNum=k.value.current,w.pageSize=k.value.pageSize,R(w)},selectDictLabel:d,statusOptions:p,typeOptions:T},h(O)),t(U,a({hasSelected:x,onSelectChange:e=>{console.log("selectedRowKeys changed: ",e),O.selectedRowKeys=e},open:L,drawerTitle:K,formState:F,labelCol:{span:4},wrapperCol:{span:18},rules:{noticeTitle:[{required:!0,message:"标题不能为空",trigger:"blur"}],noticeType:[{required:!0,message:"类型不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]},formRef:j,handleClose:()=>{F.id=void 0,j.value.resetFields(),console.log(j),L.value=!1},handleSubmit:()=>{console.log(F),j.value.validate().then((()=>{var e;F.id?(e=F,i("/admin/system/notice/"+e.id,"PUT",e)).then((e=>{b.success(e.message),R(w),F.id=void 0,j.value.resetFields(),L.value=!1})):function(e={}){return i("/admin/system/notice","POST",e)}(F).then((e=>{b.success(e.message),R(w),F.id=void 0,j.value.resetFields(),L.value=!1}))})).catch((e=>{console.log("error",e)}))},confirm:e=>{const t=e.id||O.selectedRowKeys;(function(e){return i("/admin/system/notice/"+e,"DELETE")})(t).then((()=>{(t.length&&t.length===S.value.length||1===S.value.length)&&Math.ceil(k.value.total/w.pageSize)===w.pageNum&&w.pageNum>1&&w.pageNum--,R(w),b.success("删除成功")}))},cancel:e=>{console.log(e),b.success("取消删除")},handleAdd:()=>{L.value=!0,K.value="添加消息"},handleUpdate:e=>{var t;(t=e.id,i("/admin/system/notice/"+t,"GET",{},!1)).then((e=>{L.value=!0,K.value="修改消息",C((()=>{Object.keys(F).forEach((t=>{F[t]=e.data[t]}))}))}))},disableOptions:m}));var U}});const I={class:"p-4"},D={class:"mb-3"},N=U("新增"),q=U(" 删除 "),A=U(" 修改 "),V=U(" 删除 "),B=U(" 确认 "),Q=U("取消");P.render=function(e,t,a,l,o,n){const s=T("form-search"),i=T("a-button"),c=T("a-col"),r=T("a-popconfirm"),d=T("a-row"),u=T("a-table"),p=T("a-input"),m=T("a-form-item"),f=T("a-select-option"),y=T("a-select"),v=T("a-radio-group"),g=T("a-textarea"),h=T("a-form"),b=T("a-drawer"),C=_("has-permi");return w(),S("div",I,[k("div",D,[O(s,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),O(d,{gutter:10,class:"mb-2"},{default:x((()=>[R(O(c,null,{default:x((()=>[O(i,{color:"success",onClick:e.handleAdd},{default:x((()=>[N])),_:1},8,["onClick"])])),_:1},512),[[C,["system:notice:add"]]]),R(O(c,null,{default:x((()=>[O(r,{title:"确定要删除选中数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:e.confirm,onCancel:e.cancel},{default:x((()=>[O(i,{disabled:!e.hasSelected,color:"error"},{default:x((()=>[q])),_:1},8,["disabled"])])),_:1},8,["onConfirm","onCancel"])])),_:1},512),[[C,["system:notice:delete"]]])])),_:1}),O(u,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.noticeList,pagination:e.pagination,onChange:e.handleTableChange},{status:x((({record:t})=>[k("span",null,j(e.selectDictLabel(e.statusOptions,t.status)),1)])),noticeType:x((({record:t})=>[k("span",null,j(e.selectDictLabel(e.typeOptions,t.noticeType)),1)])),action:x((({record:t})=>[k("span",null,[R(O(i,{type:"link",color:"success",class:"mr-3",onClick:a=>e.handleUpdate(t)},{default:x((()=>[A])),_:2},1032,["onClick"]),[[C,["system:notice:update"]]]),O(r,{title:"确定要删除该数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:a=>e.confirm(t),onCancel:e.cancel},{default:x((()=>[R(O(i,{type:"link",color:"error"},{default:x((()=>[V])),_:1},512),[[C,["system:notice:delete"]]])])),_:2},1032,["onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),O(b,{width:"600px",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":t[4]||(t[4]=t=>e.open=t),maskClosable:!1,onClose:e.handleClose},{default:x((()=>[e.open?(w(),F(h,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:x((()=>[O(d,null,{default:x((()=>[O(c,{span:24},{default:x((()=>[O(m,{label:"标题",name:"noticeTitle"},{default:x((()=>[O(p,{value:e.formState.noticeTitle,"onUpdate:value":t[0]||(t[0]=t=>e.formState.noticeTitle=t),placeholder:"请输入标题"},null,8,["value"])])),_:1})])),_:1}),O(c,{span:24},{default:x((()=>[O(m,{label:"类型",name:"noticeType"},{default:x((()=>[O(y,{value:e.formState.noticeType,"onUpdate:value":t[1]||(t[1]=t=>e.formState.noticeType=t),placeholder:"请输入类型"},{default:x((()=>[(w(!0),S(L,null,K(e.typeOptions,(e=>(w(),F(f,{key:e.id,value:e.dictValue},{default:x((()=>[U(j(e.dictLabel),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1}),O(c,{span:24},{default:x((()=>[O(m,{label:"状态",name:"status"},{default:x((()=>[O(v,{value:e.formState.status,"onUpdate:value":t[2]||(t[2]=t=>e.formState.status=t),options:e.disableOptions},null,8,["value","options"])])),_:1})])),_:1}),O(c,{span:24},{default:x((()=>[O(m,{label:"内容",name:"noticeContent"},{default:x((()=>[O(g,{rows:3,value:e.formState.noticeContent,"onUpdate:value":t[3]||(t[3]=t=>e.formState.noticeContent=t),placeholder:"请输入内容"},null,8,["value"])])),_:1})])),_:1}),O(c,{span:24},{default:x((()=>[O(m,null,{default:x((()=>[O(i,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:x((()=>[B])),_:1},8,["onClick"]),O(i,{onClick:e.handleClose},{default:x((()=>[Q])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):z("",!0)])),_:1},8,["title","visible","onClose"])])};export{P as default};
