import{a as e,j as t,k as a,l,m as o,f as n,h as s,n as r}from"./index.2c6e8c15.js";import{u}from"./useI18n.94ac6758.js";import{d,r as i,e as m,q as c,t as p,A as f,k as v,x as b,V as g,U as _,F as h,Z as y,v as S,B as k,c as C,a as T,f as x,M as I,n as j,a3 as w,a4 as O,H as M}from"./ant-design-vue.5cd75ca8.js";import{T as F,f as z}from"./validate.05ef885d.js";import{u as U}from"./useDrawer.6ddc8ed7.js";import{g as A}from"./dictFormat.b2531267.js";const N={"../../icons/close.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/close.450593be.svg"}),"../../icons/exitFullScreen.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/exitFullScreen.1d9e4126.svg"}),"../../icons/fullScreen.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/fullScreen.1a03daf4.svg"}),"../../icons/language.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/language.2331f79f.svg"}),"../../icons/nav-approvalManagement.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-approvalManagement.ca478867.svg"}),"../../icons/nav-baseInfo.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-baseInfo.6e90abb7.svg"}),"../../icons/nav-finance.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-finance.7b46882b.svg"}),"../../icons/nav-home.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-home.a3e6b3f3.svg"}),"../../icons/nav-sys.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-sys.c9d2f242.svg"}),"../../icons/nav-system.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-system.e82f1343.svg"}),"../../icons/search.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/search.c02878dc.svg"}),"../../icons/setting.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/setting.3836908b.svg"}),"../../icons/tabs-left.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/tabs-left.6cd9927a.svg"}),"../../icons/tabs-right.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/tabs-right.88c47129.svg"})};var E=Object.keys(N).map((e=>e.replace(/(.*\/)*([^.]+).*/,"$2"))),R=d({props:{value:{type:String,required:!0}},emits:["change"],setup(e,{emit:t}){const{t:a}=u(),l=i(e.value);m((()=>{l.value=e.value}));return{t:a,icons:E,selected:l,handleChange:e=>{t("change",e)},reset:()=>{l.value=""}}}});const P={class:"flex items-center"},q={class:"flex items-center"},B={class:"mr-2"};R.render=function(e,t,a,l,o,n){const s=c("svg-icon"),r=c("a-select-option"),u=c("a-select");return p(),f("div",P,[v(u,{value:e.selected,"onUpdate:value":t[0]||(t[0]=t=>e.selected=t),style:{width:"100%"},placeholder:e.t("common.resetText"),"option-label-prop":"label",onChange:e.handleChange},{suffixIcon:b((()=>[v(s,{name:e.selected,size:"12"},null,8,["name"])])),default:b((()=>[v(r,{value:"",label:e.t("common.nothing")},{default:b((()=>[g(_(e.t("common.nothing")),1)])),_:1},8,["label"]),(p(!0),f(h,null,y(e.icons,(e=>(p(),S(r,{value:e,label:e,key:e},{default:b((()=>[k("div",q,[k("span",B,_(e),1),v(s,{name:e},null,8,["name"])])])),_:2},1032,["value","label"])))),128))])),_:1},8,["value","placeholder","onChange"])])};const{t:D}=u(),V=[{title:D("routes.menu.title"),dataIndex:"title",key:"title"},{title:D("routes.menu.icon"),dataIndex:"icon",key:"icon",align:"center",slots:{customRender:"icon"}},{title:D("routes.menu.orderNum"),dataIndex:"orderNum",key:"orderNum",align:"center"},{title:D("routes.menu.perms"),dataIndex:"perms",key:"perms",align:"center"},{title:D("routes.menu.component"),dataIndex:"component",key:"component",align:"center"},{title:D("routes.menu.status"),dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:D("routes.menu.visible"),dataIndex:"visible",key:"visible",align:"center",slots:{customRender:"visible"}},{title:D("routes.menu.createdAt"),dataIndex:"createdAt",key:"createdAt",align:"center"},{title:D("routes.menu.action"),key:"action",align:"center",slots:{customRender:"action"}}];var L=d({components:{IconSelect:R,Treeselect:F},setup(){const u=C((()=>e().loading)),d=i([]),m=i([]),c=i(),p=i(Object.keys(t)),f=i(),v=i([{id:0,title:D("routes.menu.homeDirectory"),children:[]}]),b=i([]),g=()=>{n().then((e=>{b.value=s(e.data.rows,"id","parentId").tree,v.value[0].children=s(e.data.rows,"id").tree}))},_=T({id:void 0,parentId:void 0,menuType:"M",icon:void 0,title:void 0,orderNum:"1",path:void 0,component:void 0,perms:void 0,visible:"1",status:"1",keepAlive:1,isFrame:"0"}),h={parentId:[{required:!0,validator:z.number,message:D("routes.menu.parentIdCannotBeEmpty"),trigger:"change"}],title:[{required:!0,message:D("routes.menu.titleCannotBeEmpty"),trigger:"blur"}],orderNum:[{required:!0,validator:z.number,message:D("routes.menu.orderNumCannotBeEmpty"),trigger:"blur"}],path:[{required:!0,message:D("routes.menu.pathCannotBeEmpty"),trigger:"blur"},{validator:(e,t)=>"M"===_.menuType&&"string"==typeof t&&"/"!==t.charAt(0)?Promise.reject(D("routes.menu.menuTypeRule")):Promise.resolve(),trigger:"blur"}],component:[{required:!0,message:D("routes.menu.componentCannotBeEmpty"),trigger:"blur"}],perms:[{required:!0,message:D("routes.menu.permsCannotBeEmpty"),trigger:"blur"}]},{open:y,drawerTitle:S}=U();return x((async()=>{d.value=await A("sys_normal_disable"),m.value=await A("sys_show_hide"),d.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),m.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),g()})),{t:D,loading:u,menuList:b,confirm:e=>{o(e.id).then((()=>{g(),I.success(D("common.deleteSuccess"))}))},cancel:e=>{I.success(D("common.cancelDelete"))},columns:V,handleAdd:e=>{n().then((t=>{t.data.rows.forEach((e=>{e.isDisabled=!1})),v.value[0].children=s(t.data.rows,"id").tree,y.value=!0,S.value=D("common.add"),null!=e&&e.id&&j((()=>{_.parentId=e.id,c.value.forest.selectedNodeIds.push(e.id)}))}))},handleUpdate:e=>{n().then((t=>{t.data.rows.forEach((t=>{t.id===e.id?t.isDisabled=!0:t.isDisabled=!1})),v.value[0].children=s(t.data.rows,"id").tree,r(e.id).then((e=>{y.value=!0,S.value=D("common.update"),j((()=>{Object.keys(_).forEach((t=>{_[t]=e.data[t]})),c.value.forest.selectedNodeIds.push(e.data.parentId)}))}))}))},open:y,drawerTitle:S,handleClose:()=>{_.id=void 0,f.value.resetFields(),y.value=!1},handleSubmit:()=>{f.value.validate().then((()=>{_.id?a(_).then((e=>{I.success(e.message),g(),_.id=void 0,f.value.resetFields(),y.value=!1})):l(_).then((e=>{I.success(e.message),g(),_.id=void 0,f.value.resetFields(),y.value=!1}))})).catch((e=>{}))},formState:_,dynamicComponents:p,labelCol:{span:6},wrapperCol:{span:18},normalizer:e=>({id:e.id,label:e.title,children:e.children}),treeOptions:v,rules:h,formRef:f,handleIconChange:e=>{_.icon=e},treeRef:c,handleTreeSelect:e=>{_.parentId=e.id},disableOptions:d,showOrHideOptions:m}}});const H={class:"p-4"},K={class:"flex justify-center"},Z={class:"flex justify-center"},$={class:"flex justify-center"};L.render=function(e,t,a,l,o,n){const s=c("a-button"),r=c("a-col"),u=c("a-row"),d=c("svg-icon"),i=c("a-popconfirm"),m=c("a-table"),C=c("treeselect"),T=c("a-form-item"),x=c("a-radio-group"),I=c("a-input"),j=c("IconSelect"),F=c("a-input-number"),z=c("a-select-option"),U=c("a-select"),A=c("a-form"),N=c("a-drawer"),E=w("has-permi");return p(),f("div",H,[v(u,{gutter:10,class:"mb-2"},{default:b((()=>[O(v(r,null,{default:b((()=>[v(s,{color:"success",onClick:e.handleAdd},{default:b((()=>[g(_(e.t("common.add")),1)])),_:1},8,["onClick"])])),_:1},512),[[E,["system:menu:add"]]])])),_:1}),v(m,{loading:e.loading,rowKey:"id",columns:e.columns,"data-source":e.menuList,defaultExpandAllRows:!0,pagination:!1},{icon:b((({record:e})=>[k("div",K,[v(d,{name:e.icon},null,8,["name"])])])),status:b((({record:t})=>[k("div",Z,[k("span",null,_("1"===t.status?e.t("common.normal"):e.t("common.deactivate")),1)])])),visible:b((({record:t})=>[k("div",$,[k("span",null,_("1"===t.visible?e.t("common.show"):e.t("common.hidden")),1)])])),action:b((({record:t})=>[k("span",null,[O(v(s,{type:"link",color:"success",class:"mr-3",onClick:a=>e.handleAdd(t)},{default:b((()=>[g(_(e.t("common.add")),1)])),_:2},1032,["onClick"]),[[E,["system:menu:add"]]]),O(v(s,{type:"link",color:"success",class:"mr-3",onClick:a=>e.handleUpdate(t)},{default:b((()=>[g(_(e.t("common.update")),1)])),_:2},1032,["onClick"]),[[E,["system:menu:update"]]]),v(i,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:a=>e.confirm(t),onCancel:e.cancel},{default:b((()=>[O(v(s,{type:"link",color:"error"},{default:b((()=>[g(_(e.t("common.delete")),1)])),_:1},512),[[E,["system:menu:delete"]]])])),_:2},1032,["title","ok-text","cancel-text","onConfirm","onCancel"])])])),_:1},8,["loading","columns","data-source"]),v(N,{width:"50%",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":t[12]||(t[12]=t=>e.open=t),maskClosable:!1,onClose:e.handleClose},{default:b((()=>[e.open?(p(),S(A,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:b((()=>[v(u,null,{default:b((()=>[v(r,{span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.parentId"),name:"parentId"},{default:b((()=>[v(C,{ref:"treeRef",class:"!mt-[3px]",modelValue:e.formState.parentId,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formState.parentId=t),normalizer:e.normalizer,placeholder:e.t("routes.menu.parentIdPlaceholder"),options:e.treeOptions,onSelect:e.handleTreeSelect},null,8,["modelValue","normalizer","placeholder","options","onSelect"])])),_:1},8,["label"])])),_:1}),v(r,{span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.menuType"),name:"menuType"},{default:b((()=>[v(x,{value:e.formState.menuType,"onUpdate:value":t[1]||(t[1]=t=>e.formState.menuType=t),options:[{label:e.t("routes.menu.M"),value:"M"},{label:e.t("routes.menu.C"),value:"C"},{label:e.t("routes.menu.F"),value:"F"}]},null,8,["value","options"])])),_:1},8,["label"])])),_:1}),v(r,{span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.title"),name:"title"},{default:b((()=>[v(I,{value:e.formState.title,"onUpdate:value":t[2]||(t[2]=t=>e.formState.title=t),placeholder:e.t("routes.menu.titlePlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),"F"!==e.formState.menuType?(p(),S(r,{key:0,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.icon"),name:"icon"},{default:b((()=>[v(j,{value:e.formState.icon,"onUpdate:value":t[3]||(t[3]=t=>e.formState.icon=t),placeholder:e.t("routes.menu.iconPlaceholder"),onChange:e.handleIconChange},null,8,["value","placeholder","onChange"])])),_:1},8,["label"])])),_:1})):M("",!0),v(r,{span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.orderNum"),name:"orderNum"},{default:b((()=>[v(F,{class:"!w-[100%]",value:e.formState.orderNum,"onUpdate:value":t[4]||(t[4]=t=>e.formState.orderNum=t),placeholder:e.t("routes.menu.orderNumPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),"F"!==e.formState.menuType?(p(),S(r,{key:1,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.path"),name:"path"},{default:b((()=>[v(I,{value:e.formState.path,"onUpdate:value":t[5]||(t[5]=t=>e.formState.path=t),placeholder:e.t("routes.menu.pathNumPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1})):M("",!0),"C"===e.formState.menuType||"M"===e.formState.menuType?(p(),S(r,{key:2,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.component"),name:"component"},{default:b((()=>[v(U,{placeholder:e.t("routes.menu.componentPlaceholder"),value:e.formState.component,"onUpdate:value":t[6]||(t[6]=t=>e.formState.component=t)},{default:b((()=>[(p(!0),f(h,null,y(e.dynamicComponents,(e=>(p(),S(z,{key:e,value:e},{default:b((()=>[g(_(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["label"])])),_:1})):M("",!0),"F"===e.formState.menuType?(p(),S(r,{key:3,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.perms"),name:"perms"},{default:b((()=>[v(I,{value:e.formState.perms,"onUpdate:value":t[7]||(t[7]=t=>e.formState.perms=t),placeholder:e.t("routes.menu.permsPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1})):M("",!0),"F"!==e.formState.menuType?(p(),S(r,{key:4,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.visible"),name:"visible"},{default:b((()=>[v(x,{value:e.formState.visible,"onUpdate:value":t[8]||(t[8]=t=>e.formState.visible=t),options:e.showOrHideOptions},null,8,["value","options"])])),_:1},8,["label"])])),_:1})):M("",!0),v(r,{span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.status"),name:"status"},{default:b((()=>[v(x,{value:e.formState.status,"onUpdate:value":t[9]||(t[9]=t=>e.formState.status=t),options:e.disableOptions},null,8,["value","options"])])),_:1},8,["label"])])),_:1}),"F"!==e.formState.menuType?(p(),S(r,{key:5,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.keepAlive"),name:"keepAlive"},{default:b((()=>[v(x,{value:e.formState.keepAlive,"onUpdate:value":t[10]||(t[10]=t=>e.formState.keepAlive=t),options:[{label:e.t("routes.menu.cache"),value:1},{label:e.t("routes.menu.noCache"),value:0}]},null,8,["value","options"])])),_:1},8,["label"])])),_:1})):M("",!0),"F"!==e.formState.menuType?(p(),S(r,{key:6,span:12},{default:b((()=>[v(T,{label:e.t("routes.menu.isFrame"),name:"isFrame"},{default:b((()=>[v(x,{value:e.formState.isFrame,"onUpdate:value":t[11]||(t[11]=t=>e.formState.isFrame=t),options:[{label:e.t("routes.menu.yes"),value:"1"},{label:e.t("routes.menu.no"),value:"0"}]},null,8,["value","options"])])),_:1},8,["label"])])),_:1})):M("",!0),v(r,{span:24},{default:b((()=>[v(T,null,{default:b((()=>[v(s,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:b((()=>[g(_(e.t("common.okText")),1)])),_:1},8,["onClick"]),v(s,{onClick:e.handleClose},{default:b((()=>[g(_(e.t("common.cancelText")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):M("",!0)])),_:1},8,["title","visible","onClose"])])};export{L as default};
