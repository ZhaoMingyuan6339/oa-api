var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{l as r,u as d,a as i,d as c,g as u}from"./index.9d115300.js";import{g as p,s as m}from"./dictFormat.fa6d45c4.js";import{u as f}from"./useDrawer.60140d94.js";import{a as g}from"./index.e0281189.js";import{_ as v}from"./index.d425032d.js";import{d as y,c as h,r as b,a as C,f as w,a6 as _,M as k,n as S,l as T,a3 as N,m as x,A as R,B as O,v as j,t as F,a4 as K,V as U,q as z,H as I,U as L}from"./ant-design-vue.8fffeee5.js";const P=[{title:"字典名称",dataIndex:"dictName",key:"dictName",align:"center"},{title:"字典类型",dataIndex:"dictType",key:"dictType",align:"center",slots:{customRender:"dictType"}},{title:"状态",dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:"备注",dataIndex:"remark",key:"remark",align:"center"},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"操作",key:"action",align:"center",slots:{customRender:"action"}}];var q=y({components:{FormSearch:v},setup(){const e=h((()=>g().loading)),v=b([]),y=b([]),T=C([{type:"input",label:"字典名称",name:"dictName",value:"",placeholder:"请输入字典名称"},{type:"input",label:"字典类型",name:"dictType",value:"",placeholder:"请输入字典类型"},{type:"select",label:"状态",name:"status",value:void 0,placeholder:"请选择角色状态",normalizer:{value:"dictValue",label:"dictLabel"},options:y}]),N=C({pageNum:1,pageSize:10,dictName:"",dictType:"",status:""}),x=b([]),R=b({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),O=C({selectedRowKeys:[]}),j=h((()=>O.selectedRowKeys.length>0)),F=e=>{r(e).then((e=>{console.log(e),x.value=e.data.rows,R.value.total=e.data.count,O.selectedRowKeys=[]}))},K=b(),U=C({id:void 0,dictName:void 0,dictType:void 0,status:"1",remark:void 0}),{open:z,drawerTitle:I}=f();console.log(z);return w((async()=>{v.value=await p("sys_normal_disable"),v.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),y.value=await p("sys_normal_disable"),console.log(y),F(N)})),L=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&n(e,t,a[t]);return e})({loading:e,queryParams:N,formFields:T,handleQuery:e=>{R.value.current=1,N.pageNum=R.value.current,N.dictName=e.dictName,N.dictType=e.dictType,N.status=e.status,F(N)},typeList:x,columns:P,pagination:R,handleTableChange:e=>{R.value=e,N.pageNum=R.value.current,N.pageSize=R.value.pageSize,F(N)},selectDictLabel:m,statusOptions:y},_(O)),a(L,t({hasSelected:j,onSelectChange:e=>{console.log("selectedRowKeys changed: ",e),O.selectedRowKeys=e},open:z,drawerTitle:I,formState:U,labelCol:{span:6},wrapperCol:{span:18},rules:{dictName:[{required:!0,message:"字典名称不能为空",trigger:"blur"}],dictType:[{required:!0,message:"字典类型不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]},formRef:K,handleClose:()=>{U.id=void 0,K.value.resetFields(),console.log(K),z.value=!1},handleSubmit:()=>{console.log(U),K.value.validate().then((()=>{U.id?d(U).then((e=>{k.success(e.message),F(N),U.id=void 0,K.value.resetFields(),z.value=!1})):i(U).then((e=>{k.success(e.message),F(N),U.id=void 0,K.value.resetFields(),z.value=!1}))})).catch((e=>{console.log("error",e)}))},confirm:e=>{const a=e.id||O.selectedRowKeys;c(a).then((()=>{(a.length&&a.length===x.value.length||1===x.value.length)&&Math.ceil(R.value.total/N.pageSize)===N.pageNum&&N.pageNum>1&&N.pageNum--,F(N),k.success("删除成功")}))},cancel:e=>{console.log(e),k.success("取消删除")},handleAdd:()=>{z.value=!0,I.value="添加字典"},handleUpdate:e=>{u(e.id).then((e=>{z.value=!0,I.value="修改字典",S((()=>{Object.keys(U).forEach((a=>{U[a]=e.data[a]}))}))}))},disableOptions:v}));var L}});const A={class:"p-4"},D={class:"mb-3"},E=L("新增"),Q=L(" 删除 "),V={class:"text-[#1890ff]"},M=L(" 修改 "),B=L(" 删除 "),H=L(" 确认 "),$=L("取消");q.render=function(e,a,t,l,o,s){const n=T("form-search"),r=T("a-button"),d=T("a-col"),i=T("a-popconfirm"),c=T("a-row"),u=T("router-link"),p=T("a-table"),m=T("a-input"),f=T("a-form-item"),g=T("a-radio-group"),v=T("a-textarea"),y=T("a-form"),h=T("a-drawer"),b=N("has-permi");return x(),R("div",A,[O("div",D,[j(n,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),j(c,{gutter:10,class:"mb-2"},{default:F((()=>[K(j(d,null,{default:F((()=>[j(r,{color:"success",onClick:e.handleAdd},{default:F((()=>[E])),_:1},8,["onClick"])])),_:1},512),[[b,["system:dictType:add"]]]),K(j(d,null,{default:F((()=>[j(i,{title:"确定要删除选中数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:e.confirm,onCancel:e.cancel},{default:F((()=>[j(r,{disabled:!e.hasSelected,color:"error"},{default:F((()=>[Q])),_:1},8,["disabled"])])),_:1},8,["onConfirm","onCancel"])])),_:1},512),[[b,["system:dictType:delete"]]])])),_:1}),j(p,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.typeList,pagination:e.pagination,onChange:e.handleTableChange},{dictType:F((({record:e})=>[j(u,{to:"dictData/"+e.id},{default:F((()=>[O("span",V,U(e.dictType),1)])),_:2},1032,["to"])])),status:F((({record:a})=>[O("span",null,U(e.selectDictLabel(e.statusOptions,a.status)),1)])),action:F((({record:a})=>[O("span",null,[K(j(r,{type:"link",color:"success",class:"mr-3",onClick:t=>e.handleUpdate(a)},{default:F((()=>[M])),_:2},1032,["onClick"]),[[b,["system:dictType:update"]]]),j(i,{title:"确定要删除该数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:t=>e.confirm(a),onCancel:e.cancel},{default:F((()=>[K(j(r,{type:"link",color:"error"},{default:F((()=>[B])),_:1},512),[[b,["system:dictType:delete"]]])])),_:2},1032,["onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),j(h,{width:"50%",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":a[4]||(a[4]=a=>e.open=a),maskClosable:!1,onClose:e.handleClose},{default:F((()=>[e.open?(x(),z(y,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:F((()=>[j(c,null,{default:F((()=>[j(d,{span:12},{default:F((()=>[j(f,{label:"字典名称",name:"dictName"},{default:F((()=>[j(m,{value:e.formState.dictName,"onUpdate:value":a[0]||(a[0]=a=>e.formState.dictName=a),placeholder:"请输入字典名称"},null,8,["value"])])),_:1})])),_:1}),j(d,{span:12},{default:F((()=>[j(f,{label:"字典类型",name:"dictType"},{default:F((()=>[j(m,{value:e.formState.dictType,"onUpdate:value":a[1]||(a[1]=a=>e.formState.dictType=a),placeholder:"请输入字典类型"},null,8,["value"])])),_:1})])),_:1}),j(d,{span:12},{default:F((()=>[j(f,{label:"状态",name:"status"},{default:F((()=>[j(g,{value:e.formState.status,"onUpdate:value":a[2]||(a[2]=a=>e.formState.status=a),options:e.disableOptions},null,8,["value","options"])])),_:1})])),_:1}),j(d,{span:12},{default:F((()=>[j(f,{label:"备注",name:"remark"},{default:F((()=>[j(v,{rows:3,value:e.formState.remark,"onUpdate:value":a[3]||(a[3]=a=>e.formState.remark=a),placeholder:"请输入备注"},null,8,["value"])])),_:1})])),_:1}),j(d,{span:24},{default:F((()=>[j(f,null,{default:F((()=>[j(r,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:F((()=>[H])),_:1},8,["onClick"]),j(r,{onClick:e.handleClose},{default:F((()=>[$])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):I("",!0)])),_:1},8,["title","visible","onClose"])])};export{q as default};
