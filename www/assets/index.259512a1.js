import{a as e,j as a,k as l,l as t,m as s,f as n,h as o,n as r}from"./index.e0281189.js";import{d as u,r as d,e as i,l as c,m,A as p,v as f,t as v,F as g,Z as b,q as _,B as h,V as y,U as S,c as k,a as C,f as T,M as j,n as w,a3 as I,a4 as O,H as x}from"./ant-design-vue.8fffeee5.js";import{T as M,f as z}from"./validate.af74362d.js";import{u as F}from"./useDrawer.60140d94.js";import{g as U}from"./dictFormat.fa6d45c4.js";const A={"../../icons/close.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/close.450593be.svg"}),"../../icons/exitFullScreen.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/exitFullScreen.1d9e4126.svg"}),"../../icons/fullScreen.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/fullScreen.1a03daf4.svg"}),"../../icons/language.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/language.2331f79f.svg"}),"../../icons/nav-approvalManagement.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-approvalManagement.ca478867.svg"}),"../../icons/nav-baseInfo.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-baseInfo.6e90abb7.svg"}),"../../icons/nav-finance.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-finance.7b46882b.svg"}),"../../icons/nav-home.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-home.a3e6b3f3.svg"}),"../../icons/nav-sys.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-sys.c9d2f242.svg"}),"../../icons/nav-system.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/nav-system.e82f1343.svg"}),"../../icons/search.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/search.c02878dc.svg"}),"../../icons/setting.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/setting.3836908b.svg"}),"../../icons/tabs-left.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/tabs-left.6cd9927a.svg"}),"../../icons/tabs-right.svg":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:"/assets/tabs-right.88c47129.svg"})};var N=Object.keys(A).map((e=>e.replace(/(.*\/)*([^.]+).*/,"$2"))),R=u({props:{value:{type:String,required:!0}},emits:["change"],setup(e,{emit:a}){const l=d(e.value);i((()=>{l.value=e.value}));return{icons:N,selected:l,handleChange:e=>{a("change",e)},reset:()=>{l.value=""}}}});const q={class:"flex items-center"},E=S("无"),V={class:"flex items-center"},D={class:"mr-2"};R.render=function(e,a,l,t,s,n){const o=c("svg-icon"),r=c("a-select-option"),u=c("a-select");return m(),p("div",q,[f(u,{value:e.selected,"onUpdate:value":a[0]||(a[0]=a=>e.selected=a),style:{width:"100%"},placeholder:"请选择图标","option-label-prop":"label",onChange:e.handleChange},{suffixIcon:v((()=>[f(o,{name:e.selected,size:"12"},null,8,["name"])])),default:v((()=>[f(r,{value:"",label:"无"},{default:v((()=>[E])),_:1}),(m(!0),p(g,null,b(e.icons,(e=>(m(),_(r,{value:e,label:e,key:e},{default:v((()=>[h("div",V,[h("span",D,y(e),1),f(o,{name:e},null,8,["name"])])])),_:2},1032,["value","label"])))),128))])),_:1},8,["value","onChange"])])};const L=[{title:"菜单名称",dataIndex:"title",key:"title"},{title:"图标",dataIndex:"icon",key:"icon",align:"center",slots:{customRender:"icon"}},{title:"排序",dataIndex:"orderNum",key:"orderNum",align:"center"},{title:"权限标识",dataIndex:"perms",key:"perms",align:"center"},{title:"组件名",dataIndex:"component",key:"component",align:"center"},{title:"状态",dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:"是否显示",dataIndex:"visible",key:"visible",align:"center",slots:{customRender:"visible"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"操作",key:"action",align:"center",slots:{customRender:"action"}}];var H=u({components:{IconSelect:R,Treeselect:M},setup(){const u=k((()=>e().loading)),i=d([]),c=d([]),m=d(),p=d(Object.keys(a)),f=d(),v=d([{id:0,title:"主目录",children:[]}]),g=d([]),b=()=>{n().then((e=>{g.value=o(e.data.rows,"id","parentId").tree,v.value[0].children=o(e.data.rows,"id").tree}))},_=C({id:void 0,parentId:void 0,menuType:"M",icon:void 0,title:void 0,orderNum:"1",path:void 0,component:void 0,perms:void 0,visible:"1",status:"1",keepAlive:1,isFrame:"0"}),h={parentId:[{required:!0,validator:z.number,message:"上级菜单不能为空",trigger:"change"}],title:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],orderNum:[{required:!0,validator:z.number,message:"显示排序不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"},{validator:(e,a)=>"M"===_.menuType&&(console.log("string"==typeof a&&"/"!==a.charAt(0)),"string"==typeof a&&"/"!==a.charAt(0))?(console.log(999),Promise.reject("菜单类型为目录，必须以 / 开头")):Promise.resolve(),trigger:"blur"}],component:[{required:!0,message:"组件不能为空",trigger:"blur"}],perms:[{required:!0,message:"权限标识不能为空",trigger:"blur"}]},{open:y,drawerTitle:S}=F();return T((async()=>{i.value=await U("sys_normal_disable"),c.value=await U("sys_show_hide"),i.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),c.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),b()})),{loading:u,menuList:g,confirm:e=>{s(e.id).then((()=>{b(),j.success("删除成功")}))},cancel:e=>{console.log(e),j.success("取消删除")},columns:L,handleAdd:e=>{n().then((a=>{a.data.rows.forEach((e=>{e.isDisabled=!1})),v.value[0].children=o(a.data.rows,"id").tree,y.value=!0,S.value="添加菜单",null!=e&&e.id&&w((()=>{_.parentId=e.id,m.value.forest.selectedNodeIds.push(e.id)}))}))},handleUpdate:e=>{n().then((a=>{a.data.rows.forEach((a=>{a.id===e.id?a.isDisabled=!0:a.isDisabled=!1})),v.value[0].children=o(a.data.rows,"id").tree,r(e.id).then((e=>{y.value=!0,S.value="修改菜单",w((()=>{Object.keys(_).forEach((a=>{_[a]=e.data[a]})),m.value.forest.selectedNodeIds.push(e.data.parentId)}))}))}))},open:y,drawerTitle:S,handleClose:()=>{_.id=void 0,f.value.resetFields(),y.value=!1},handleSubmit:()=>{f.value.validate().then((()=>{_.id?l(_).then((e=>{j.success(e.message),b(),_.id=void 0,f.value.resetFields(),y.value=!1})):t(_).then((e=>{j.success(e.message),b(),_.id=void 0,f.value.resetFields(),y.value=!1}))})).catch((e=>{console.log("error",e)}))},formState:_,dynamicComponents:p,labelCol:{span:6},wrapperCol:{span:18},normalizer:e=>({id:e.id,label:e.title,children:e.children}),treeOptions:v,rules:h,formRef:f,handleIconChange:e=>{_.icon=e},treeRef:m,handleTreeSelect:e=>{_.parentId=e.id},disableOptions:i,showOrHideOptions:c}}});const P={class:"p-4"},B=S(" 新增 "),K={class:"flex justify-center"},Z={class:"flex justify-center"},$={class:"flex justify-center"},G=S(" 新增 "),J=S(" 修改 "),Q=S(" 删除 "),W=S(" 确认 "),X=S("取消");H.render=function(e,a,l,t,s,n){const o=c("a-button"),r=c("a-col"),u=c("a-row"),d=c("svg-icon"),i=c("a-popconfirm"),k=c("a-table"),C=c("treeselect"),T=c("a-form-item"),j=c("a-radio-group"),w=c("a-input"),M=c("IconSelect"),z=c("a-input-number"),F=c("a-select-option"),U=c("a-select"),A=c("a-form"),N=c("a-drawer"),R=I("has-permi");return m(),p("div",P,[f(u,{gutter:10,class:"mb-2"},{default:v((()=>[O(f(r,null,{default:v((()=>[f(o,{color:"success",onClick:e.handleAdd},{default:v((()=>[B])),_:1},8,["onClick"])])),_:1},512),[[R,["system:menu:add"]]])])),_:1}),f(k,{loading:e.loading,rowKey:"id",columns:e.columns,"data-source":e.menuList,defaultExpandAllRows:!0,pagination:!1},{icon:v((({record:e})=>[h("div",K,[f(d,{name:e.icon},null,8,["name"])])])),status:v((({record:e})=>[h("div",Z,[h("span",null,y("1"===e.status?"正常":"停用"),1)])])),visible:v((({record:e})=>[h("div",$,[h("span",null,y("1"===e.visible?"显示":"隐藏"),1)])])),action:v((({record:a})=>[h("span",null,[O(f(o,{type:"link",color:"success",class:"mr-3",onClick:l=>e.handleAdd(a)},{default:v((()=>[G])),_:2},1032,["onClick"]),[[R,["system:menu:add"]]]),O(f(o,{type:"link",color:"success",class:"mr-3",onClick:l=>e.handleUpdate(a)},{default:v((()=>[J])),_:2},1032,["onClick"]),[[R,["system:menu:update"]]]),f(i,{title:"确定要删除该数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:l=>e.confirm(a),onCancel:e.cancel},{default:v((()=>[O(f(o,{type:"link",color:"error"},{default:v((()=>[Q])),_:1},512),[[R,["system:menu:delete"]]])])),_:2},1032,["onConfirm","onCancel"])])])),_:1},8,["loading","columns","data-source"]),f(N,{width:"50%",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":a[12]||(a[12]=a=>e.open=a),maskClosable:!1,onClose:e.handleClose},{default:v((()=>[e.open?(m(),_(A,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:v((()=>[f(u,null,{default:v((()=>[f(r,{span:12},{default:v((()=>[f(T,{label:"上级菜单",name:"parentId"},{default:v((()=>[f(C,{ref:"treeRef",class:"!mt-[3px]",modelValue:e.formState.parentId,"onUpdate:modelValue":a[0]||(a[0]=a=>e.formState.parentId=a),normalizer:e.normalizer,placeholder:"请选择上级菜单",options:e.treeOptions,onSelect:e.handleTreeSelect},null,8,["modelValue","normalizer","options","onSelect"])])),_:1})])),_:1}),f(r,{span:12},{default:v((()=>[f(T,{label:"菜单类型",name:"menuType"},{default:v((()=>[f(j,{value:e.formState.menuType,"onUpdate:value":a[1]||(a[1]=a=>e.formState.menuType=a),options:[{label:"目录",value:"M"},{label:"菜单",value:"C"},{label:"按钮",value:"F"}]},null,8,["value"])])),_:1})])),_:1}),f(r,{span:12},{default:v((()=>[f(T,{label:"菜单名称",name:"title"},{default:v((()=>[f(w,{value:e.formState.title,"onUpdate:value":a[2]||(a[2]=a=>e.formState.title=a),placeholder:"请输入菜单名称"},null,8,["value"])])),_:1})])),_:1}),"F"!==e.formState.menuType?(m(),_(r,{key:0,span:12},{default:v((()=>[f(T,{label:"菜单图标",name:"icon"},{default:v((()=>[f(M,{value:e.formState.icon,"onUpdate:value":a[3]||(a[3]=a=>e.formState.icon=a),placeholder:"选择菜单图标",onChange:e.handleIconChange},null,8,["value","onChange"])])),_:1})])),_:1})):x("",!0),f(r,{span:12},{default:v((()=>[f(T,{label:"显示排序",name:"orderNum"},{default:v((()=>[f(z,{class:"!w-[100%]",value:e.formState.orderNum,"onUpdate:value":a[4]||(a[4]=a=>e.formState.orderNum=a),placeholder:"请输入显示排序"},null,8,["value"])])),_:1})])),_:1}),"F"!==e.formState.menuType?(m(),_(r,{key:1,span:12},{default:v((()=>[f(T,{label:"路由地址",name:"path"},{default:v((()=>[f(w,{value:e.formState.path,"onUpdate:value":a[5]||(a[5]=a=>e.formState.path=a),placeholder:"请输入路由地址"},null,8,["value"])])),_:1})])),_:1})):x("",!0),"C"===e.formState.menuType||"M"===e.formState.menuType?(m(),_(r,{key:2,span:12},{default:v((()=>[f(T,{label:"组件名",name:"component"},{default:v((()=>[f(U,{placeholder:"请输入组件名",value:e.formState.component,"onUpdate:value":a[6]||(a[6]=a=>e.formState.component=a)},{default:v((()=>[(m(!0),p(g,null,b(e.dynamicComponents,(e=>(m(),_(F,{key:e,value:e},{default:v((()=>[S(y(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1})):x("",!0),"F"===e.formState.menuType?(m(),_(r,{key:3,span:12},{default:v((()=>[f(T,{label:"权限标识",name:"perms"},{default:v((()=>[f(w,{value:e.formState.perms,"onUpdate:value":a[7]||(a[7]=a=>e.formState.perms=a),placeholder:"请输入权限标识"},null,8,["value"])])),_:1})])),_:1})):x("",!0),"F"!==e.formState.menuType?(m(),_(r,{key:4,span:12},{default:v((()=>[f(T,{label:"显示状态",name:"visible"},{default:v((()=>[f(j,{value:e.formState.visible,"onUpdate:value":a[8]||(a[8]=a=>e.formState.visible=a),options:e.showOrHideOptions},null,8,["value","options"])])),_:1})])),_:1})):x("",!0),f(r,{span:12},{default:v((()=>[f(T,{label:"菜单状态",name:"status"},{default:v((()=>[f(j,{value:e.formState.status,"onUpdate:value":a[9]||(a[9]=a=>e.formState.status=a),options:e.disableOptions},null,8,["value","options"])])),_:1})])),_:1}),"F"!==e.formState.menuType?(m(),_(r,{key:5,span:12},{default:v((()=>[f(T,{label:"是否缓存",name:"keepAlive"},{default:v((()=>[f(j,{value:e.formState.keepAlive,"onUpdate:value":a[10]||(a[10]=a=>e.formState.keepAlive=a),options:[{label:"缓存",value:1},{label:"不缓存",value:0}]},null,8,["value"])])),_:1})])),_:1})):x("",!0),"F"!==e.formState.menuType?(m(),_(r,{key:6,span:12},{default:v((()=>[f(T,{label:"是否外链",name:"isFrame"},{default:v((()=>[f(j,{value:e.formState.isFrame,"onUpdate:value":a[11]||(a[11]=a=>e.formState.isFrame=a),options:[{label:"是",value:"1"},{label:"否",value:"0"}]},null,8,["value"])])),_:1})])),_:1})):x("",!0),f(r,{span:24},{default:v((()=>[f(T,null,{default:v((()=>[f(o,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:v((()=>[W])),_:1},8,["onClick"]),f(o,{onClick:e.handleClose},{default:v((()=>[X])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):x("",!0)])),_:1},8,["title","visible","onClose"])])};export{H as default};
