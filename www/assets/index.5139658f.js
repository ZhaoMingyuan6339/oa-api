var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{H as r,a as d}from"./index.e0281189.js";import{s as i}from"./dictFormat.fa6d45c4.js";import{u as c}from"./useDrawer.60140d94.js";import{_ as u}from"./index.d425032d.js";import{d as m,c as f,a as p,r as g,f as y,a6 as v,M as h,n as C,l as k,a3 as b,m as w,A as S,B as _,v as N,t as x,a4 as R,q as j,H as O,U as T}from"./ant-design-vue.8fffeee5.js";const F=[{title:"参数名称",dataIndex:"name",key:"name",align:"center"},{title:"参数键名",dataIndex:"keyName",key:"keyName",align:"center"},{title:"参数键值",dataIndex:"key",key:"key",align:"center"},{title:"备注",dataIndex:"remark",key:"remark",align:"center"},{title:"创建者",dataIndex:"createdBy",key:"createdBy",align:"center"},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",align:"center"},{title:"操作",key:"action",align:"center",slots:{customRender:"action"}}];var K=m({components:{FormSearch:u},setup(){const e=f((()=>d().loading)),u=p([{type:"input",label:"参数名称",name:"name",value:"",placeholder:"请输入参数名称"}]),m=p({pageNum:1,pageSize:10,name:"",keyName:"",status:""}),k=g([]),b=g({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),w=p({selectedRowKeys:[]}),S=f((()=>w.selectedRowKeys.length>0)),_=e=>{(function(e={}){return r("/admin/system/systemConfig","GET",e)})(e).then((e=>{console.log(e),k.value=e.data.rows,b.value.total=e.data.count,w.selectedRowKeys=[]}))},N=g(),x=p({id:void 0,name:void 0,keyName:void 0,status:"1",key:void 0}),{open:R,drawerTitle:j}=c();console.log(R);return y((async()=>{_(m)})),O=((e,a)=>{for(var l in a||(a={}))n.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&s(e,l,a[l]);return e})({loading:e,queryParams:m,formFields:u,handleQuery:e=>{b.value.current=1,m.pageNum=b.value.current,m.name=e.name,m.keyName=e.keyName,m.status=e.status,_(m)},systemConfigList:k,columns:F,pagination:b,handleTableChange:e=>{b.value=e,m.pageNum=b.value.current,m.pageSize=b.value.pageSize,_(m)},selectDictLabel:i},v(w)),a(O,l({hasSelected:S,onSelectChange:e=>{console.log("selectedRowKeys changed: ",e),w.selectedRowKeys=e},open:R,drawerTitle:j,formState:x,labelCol:{span:4},wrapperCol:{span:18},rules:{name:[{required:!0,message:"参数名称不能为空",trigger:"blur"}],keyName:[{required:!0,message:"参数键名不能为空",trigger:"blur"}],key:[{required:!0,message:"参数键值不能为空",trigger:"change"}]},formRef:N,handleClose:()=>{x.id=void 0,N.value.resetFields(),console.log(N),R.value=!1},handleSubmit:()=>{console.log(x),N.value.validate().then((()=>{var e;x.id?(e=x,r("/admin/system/systemConfig/"+e.id,"PUT",e)).then((e=>{h.success(e.message),_(m),x.id=void 0,N.value.resetFields(),R.value=!1})):function(e={}){return r("/admin/system/systemConfig","POST",e)}(x).then((e=>{h.success(e.message),_(m),x.id=void 0,N.value.resetFields(),R.value=!1}))})).catch((e=>{console.log("error",e)}))},confirm:e=>{const a=e.id||w.selectedRowKeys;(function(e){return r("/admin/system/systemConfig/"+e,"DELETE")})(a).then((()=>{(a.length&&a.length===k.value.length||1===k.value.length)&&Math.ceil(b.value.total/m.pageSize)===m.pageNum&&m.pageNum>1&&m.pageNum--,_(m),h.success("删除成功")}))},cancel:e=>{console.log(e),h.success("取消删除")},handleAdd:()=>{R.value=!0,j.value="添加配置"},handleUpdate:e=>{var a;(a=e.id,r("/admin/system/systemConfig/"+a,"GET",{},!1)).then((e=>{R.value=!0,j.value="修改配置",C((()=>{Object.keys(x).forEach((a=>{x[a]=e.data[a]}))}))}))}}));var O}});const U={class:"p-4"},P={class:"mb-3"},E=T("新增"),I=T(" 删除 "),z=T(" 修改 "),q=T(" 删除 "),A=T(" 确认 "),D=T("取消");K.render=function(e,a,l,t,n,o){const s=k("form-search"),r=k("a-button"),d=k("a-col"),i=k("a-popconfirm"),c=k("a-row"),u=k("a-table"),m=k("a-input"),f=k("a-form-item"),p=k("a-textarea"),g=k("a-form"),y=k("a-drawer"),v=b("has-permi");return w(),S("div",U,[_("div",P,[N(s,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),N(c,{gutter:10,class:"mb-2"},{default:x((()=>[R(N(d,null,{default:x((()=>[N(r,{color:"success",onClick:e.handleAdd},{default:x((()=>[E])),_:1},8,["onClick"])])),_:1},512),[[v,["system:systemConfig:add"]]]),R(N(d,null,{default:x((()=>[N(i,{title:"确定要删除选中数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:e.confirm,onCancel:e.cancel},{default:x((()=>[N(r,{disabled:!e.hasSelected,color:"error"},{default:x((()=>[I])),_:1},8,["disabled"])])),_:1},8,["onConfirm","onCancel"])])),_:1},512),[[v,["system:systemConfig:delete"]]])])),_:1}),N(u,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.systemConfigList,pagination:e.pagination,onChange:e.handleTableChange},{action:x((({record:a})=>[_("span",null,[R(N(r,{type:"link",color:"success",class:"mr-3",onClick:l=>e.handleUpdate(a)},{default:x((()=>[z])),_:2},1032,["onClick"]),[[v,["system:systemConfig:update"]]]),N(i,{title:"确定要删除该数据吗？","ok-text":"确定","cancel-text":"取消",onConfirm:l=>e.confirm(a),onCancel:e.cancel},{default:x((()=>[R(N(r,{type:"link",color:"error"},{default:x((()=>[q])),_:1},512),[[v,["system:systemConfig:delete"]]])])),_:2},1032,["onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),N(y,{width:"600px",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":a[4]||(a[4]=a=>e.open=a),maskClosable:!1,onClose:e.handleClose},{default:x((()=>[e.open?(w(),j(g,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:x((()=>[N(c,null,{default:x((()=>[N(d,{span:24},{default:x((()=>[N(f,{label:"参数名称",name:"name"},{default:x((()=>[N(m,{value:e.formState.name,"onUpdate:value":a[0]||(a[0]=a=>e.formState.name=a),placeholder:"请输入参数名称"},null,8,["value"])])),_:1})])),_:1}),N(d,{span:24},{default:x((()=>[N(f,{label:"参数键名",name:"keyName"},{default:x((()=>[N(m,{value:e.formState.keyName,"onUpdate:value":a[1]||(a[1]=a=>e.formState.keyName=a),placeholder:"请输入参数键名"},null,8,["value"])])),_:1})])),_:1}),N(d,{span:24},{default:x((()=>[N(f,{label:"参数键值",name:"key"},{default:x((()=>[N(m,{value:e.formState.key,"onUpdate:value":a[2]||(a[2]=a=>e.formState.key=a),placeholder:"请输入参数键值"},null,8,["value"])])),_:1})])),_:1}),N(d,{span:24},{default:x((()=>[N(f,{label:"备注",name:"remark"},{default:x((()=>[N(p,{rows:3,value:e.formState.remark,"onUpdate:value":a[3]||(a[3]=a=>e.formState.remark=a),placeholder:"请输入备注"},null,8,["value"])])),_:1})])),_:1}),N(d,{span:24},{default:x((()=>[N(f,null,{default:x((()=>[N(r,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:x((()=>[A])),_:1},8,["onClick"]),N(r,{onClick:e.handleClose},{default:x((()=>[D])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):O("",!0)])),_:1},8,["title","visible","onClose"])])};export{K as default};
