var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o;"undefined"!=typeof require&&require;import{H as c,a as i}from"./index.2c6e8c15.js";import{g as r,s as u}from"./dictFormat.b2531267.js";import{u as d}from"./useDrawer.6ddc8ed7.js";import{_ as m}from"./index.440d206b.js";import{u as p}from"./useI18n.94ac6758.js";import{d as f,c as y,r as v,a as h,f as g,a6 as b,M as T,n as C,q as _,a3 as w,t as k,A as S,B as x,k as O,x as R,a4 as j,V as P,U as E,v as F,F as L,Z as D,H as U}from"./ant-design-vue.5cd75ca8.js";const{t:z}=p(),I=[{title:z("routes.notice.noticeTitle"),dataIndex:"noticeTitle",key:"noticeTitle",align:"center"},{title:z("routes.notice.noticeType"),dataIndex:"noticeType",key:"noticeType",align:"center",slots:{customRender:"noticeType"}},{title:z("routes.notice.noticeContent"),dataIndex:"noticeContent",key:"noticeContent",align:"center"},{title:z("routes.notice.status"),dataIndex:"status",key:"status",align:"center",slots:{customRender:"status"}},{title:z("routes.notice.createdBy"),dataIndex:"createdBy",key:"createdBy",align:"center"},{title:z("routes.notice.createdAt"),dataIndex:"createdAt",key:"createdAt",align:"center"},{title:z("routes.notice.action"),key:"action",align:"center",slots:{customRender:"action"}}];var K=f({components:{FormSearch:m},setup(){const e=y((()=>i().loading)),m=v([]),p=v([]),f=v([]),_={noticeTitle:[{required:!0,message:z("routes.notice.noticeTitleCannotBeEmpty"),trigger:"blur"}],noticeType:[{required:!0,message:z("routes.notice.noticeTypeCannotBeEmpty"),trigger:"blur"}],status:[{required:!0,message:z("routes.notice.statusCannotBeEmpty"),trigger:"change"}]},w=h([{type:"input",label:z("routes.notice.noticeTitle"),name:"noticeTitle",value:"",placeholder:z("routes.notice.noticeTitlePlaceholder")},{type:"select",label:z("routes.notice.noticeType"),name:"noticeType",value:void 0,placeholder:z("routes.notice.noticeTypePlaceholder"),normalizer:{value:"dictValue",label:"dictLabel"},options:f},{type:"select",label:z("routes.notice.status"),name:"status",value:void 0,placeholder:z("routes.notice.statusPlaceholder"),normalizer:{value:"dictValue",label:"dictLabel"},options:m}]),k=h({pageNum:1,pageSize:10,noticeTitle:"",noticeType:"",status:""}),S=v([]),x=v({total:0,current:1,pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}),O=h({selectedRowKeys:[]}),R=y((()=>O.selectedRowKeys.length>0)),j=e=>{(function(e={}){return c("/admin/system/notice","GET",e)})(e).then((e=>{S.value=e.data.rows,x.value.total=e.data.count,O.selectedRowKeys=[]}))},P=v(),E=h({id:void 0,noticeTitle:void 0,noticeType:void 0,status:"1",noticeContent:void 0}),{open:F,drawerTitle:L}=d();return g((async()=>{m.value=await r("sys_normal_disable"),f.value=await r("sys_notice_type"),p.value=await r("sys_normal_disable"),p.value.forEach((e=>{e.label=e.dictLabel,e.value=e.dictValue})),j(k)})),D=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&s(e,a,t[a]);if(o)for(var a of o(t))n.call(t,a)&&s(e,a,t[a]);return e})({t:z,loading:e,queryParams:k,formFields:w,handleQuery:e=>{x.value.current=1,k.pageNum=x.value.current,k.noticeTitle=e.noticeTitle,k.noticeType=e.noticeType,k.status=e.status,j(k)},noticeList:S,columns:I,pagination:x,handleTableChange:e=>{x.value=e,k.pageNum=x.value.current,k.pageSize=x.value.pageSize,j(k)},selectDictLabel:u,statusOptions:m,typeOptions:f},b(O)),t(D,a({hasSelected:R,onSelectChange:e=>{O.selectedRowKeys=e},open:F,drawerTitle:L,formState:E,labelCol:{span:4},wrapperCol:{span:18},rules:_,formRef:P,handleClose:()=>{E.id=void 0,P.value.resetFields(),F.value=!1},handleSubmit:()=>{P.value.validate().then((()=>{var e;E.id?(e=E,c("/admin/system/notice/"+e.id,"PUT",e)).then((e=>{T.success(e.message),j(k),E.id=void 0,P.value.resetFields(),F.value=!1})):function(e={}){return c("/admin/system/notice","POST",e)}(E).then((e=>{T.success(e.message),j(k),E.id=void 0,P.value.resetFields(),F.value=!1}))})).catch((e=>{}))},confirm:e=>{const t=e.id||O.selectedRowKeys;(function(e){return c("/admin/system/notice/"+e,"DELETE")})(t).then((()=>{(t.length&&t.length===S.value.length||1===S.value.length)&&Math.ceil(x.value.total/k.pageSize)===k.pageNum&&k.pageNum>1&&k.pageNum--,j(k),T.success(z("common.deleteSuccess"))}))},cancel:e=>{T.success(z("common.cancelDelete"))},handleAdd:()=>{F.value=!0,L.value=z("common.add")},handleUpdate:e=>{var t;(t=e.id,c("/admin/system/notice/"+t,"GET",{},!1)).then((e=>{F.value=!0,L.value=z("common.update"),C((()=>{Object.keys(E).forEach((t=>{E[t]=e.data[t]}))}))}))},disableOptions:p}));var D}});const q={class:"p-4"},B={class:"mb-3"};K.render=function(e,t,a,o,l,n){const s=_("form-search"),c=_("a-button"),i=_("a-col"),r=_("a-popconfirm"),u=_("a-row"),d=_("a-table"),m=_("a-input"),p=_("a-form-item"),f=_("a-select-option"),y=_("a-select"),v=_("a-radio-group"),h=_("a-textarea"),g=_("a-form"),b=_("a-drawer"),T=w("has-permi");return k(),S("div",q,[x("div",B,[O(s,{formFields:e.formFields,onSearch:e.handleQuery,onReset:e.handleQuery},null,8,["formFields","onSearch","onReset"])]),O(u,{gutter:10,class:"mb-2"},{default:R((()=>[j(O(i,null,{default:R((()=>[O(c,{color:"success",onClick:e.handleAdd},{default:R((()=>[P(E(e.t("common.add")),1)])),_:1},8,["onClick"])])),_:1},512),[[T,["system:notice:add"]]]),j(O(i,null,{default:R((()=>[O(r,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:e.confirm,onCancel:e.cancel},{default:R((()=>[O(c,{disabled:!e.hasSelected,color:"error"},{default:R((()=>[P(E(e.t("common.update")),1)])),_:1},8,["disabled"])])),_:1},8,["title","ok-text","cancel-text","onConfirm","onCancel"])])),_:1},512),[[T,["system:notice:delete"]]])])),_:1}),O(d,{loading:e.loading,rowKey:"id","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},columns:e.columns,"data-source":e.noticeList,pagination:e.pagination,onChange:e.handleTableChange},{status:R((({record:t})=>[x("span",null,E(e.selectDictLabel(e.statusOptions,t.status)),1)])),noticeType:R((({record:t})=>[x("span",null,E(e.selectDictLabel(e.typeOptions,t.noticeType)),1)])),action:R((({record:t})=>[x("span",null,[j(O(c,{type:"link",color:"success",class:"mr-3",onClick:a=>e.handleUpdate(t)},{default:R((()=>[P(E(e.t("common.update")),1)])),_:2},1032,["onClick"]),[[T,["system:notice:update"]]]),O(r,{title:e.t("common.confirmDelete"),"ok-text":e.t("common.okText"),"cancel-text":e.t("common.cancelText"),onConfirm:a=>e.confirm(t),onCancel:e.cancel},{default:R((()=>[j(O(c,{type:"link",color:"error"},{default:R((()=>[P(E(e.t("common.delete")),1)])),_:1},512),[[T,["system:notice:delete"]]])])),_:2},1032,["title","ok-text","cancel-text","onConfirm","onCancel"])])])),_:1},8,["loading","row-selection","columns","data-source","pagination","onChange"]),O(b,{width:"600px",title:e.drawerTitle,placement:"right",visible:e.open,"onUpdate:visible":t[4]||(t[4]=t=>e.open=t),maskClosable:!1,onClose:e.handleClose},{default:R((()=>[e.open?(k(),F(g,{key:0,ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:R((()=>[O(u,null,{default:R((()=>[O(i,{span:24},{default:R((()=>[O(p,{label:e.t("routes.notice.noticeTitle"),name:"noticeTitle"},{default:R((()=>[O(m,{value:e.formState.noticeTitle,"onUpdate:value":t[0]||(t[0]=t=>e.formState.noticeTitle=t),placeholder:e.t("routes.notice.noticeTitle")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),O(i,{span:24},{default:R((()=>[O(p,{label:e.t("routes.notice.noticeType"),name:"noticeType"},{default:R((()=>[O(y,{value:e.formState.noticeType,"onUpdate:value":t[1]||(t[1]=t=>e.formState.noticeType=t),placeholder:e.t("routes.notice.noticeTypePlaceholder")},{default:R((()=>[(k(!0),S(L,null,D(e.typeOptions,(e=>(k(),F(f,{key:e.id,value:e.dictValue},{default:R((()=>[P(E(e.dictLabel),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),O(i,{span:24},{default:R((()=>[O(p,{label:e.t("routes.notice.status"),name:"status"},{default:R((()=>[O(v,{value:e.formState.status,"onUpdate:value":t[2]||(t[2]=t=>e.formState.status=t),options:e.disableOptions},null,8,["value","options"])])),_:1},8,["label"])])),_:1}),O(i,{span:24},{default:R((()=>[O(p,{label:e.t("routes.notice.noticeContent"),name:"noticeContent"},{default:R((()=>[O(h,{rows:3,value:e.formState.noticeContent,"onUpdate:value":t[3]||(t[3]=t=>e.formState.noticeContent=t),placeholder:e.t("routes.notice.noticeContentPlaceholder")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1}),O(i,{span:24},{default:R((()=>[O(p,null,{default:R((()=>[O(c,{type:"primary",class:"mr-3",onClick:e.handleSubmit},{default:R((()=>[P(E(e.t("common.okText")),1)])),_:1},8,["onClick"]),O(c,{onClick:e.handleClose},{default:R((()=>[P(E(e.t("common.cancelText")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","label-col","wrapper-col"])):U("",!0)])),_:1},8,["title","visible","onClose"])])};export{K as default};
